REM CHARACTER DESIGNER 0.1 BETA
REM BY TIMO KLOSS
REM 2017

DIM PXL(7,7)

REM UI COLORS
PALETTE 0,,%111111,%101010,%010101
PALETTE 6,,%110000,%000000,
PALETTE 7,,%001111,%000101,

REM BIG PIXEL COLORS (GRID AND FILL)
PALETTE 1,,%000000,%000000,
PALETTE 2,,%111111,%111111,
PALETTE 3,,%101010,%101010,
PALETTE 4,,%010101,%010101,

REM CHARACTER COLORS
PALETTE 5,,%111111,%101010,%010101


COPY START(0),LENGTH(0) TO $8000
BG SOURCE START(1)+2,PEEK(START(1))

MAIN:

SELCHAR=0
SELPAGE=0
SELCOLOR=1
HIDECOUNT=0
GOSUB READCHAR
GOSUB READPAGE
GOSUB DRAWUI
WAIT 10

OLDX=-1
OLDY=-1

DO
  IF TOUCH THEN
    X=INT(TOUCH.X/8)
    Y=INT(TOUCH.Y/8)
    IF X<>OLDX OR Y<>OLDY THEN

      IF X>=1 AND X<=8 AND Y>=2 AND Y<=9 THEN
        PXL(X-1,Y-2)=SELCOLOR
        CHAR 16,(SELCOLOR+1,0,,,)
        CELL X,Y
        GOSUB WRITECHAR
      END IF

      IF X>=10 AND X<=11 AND Y>=2 AND Y<=9 THEN
        SELCOLOR=INT((Y-2)/2)
        GOSUB DRAWSELCOLOR
      END IF

      IF X>=1 AND X<=16 AND Y>=11 AND Y<=14 THEN
        SELCHAR=((Y-11)*16)+(X-1)+SELPAGE*64
        GOSUB READCHAR
        GOSUB DRAWCHAR
        GOSUB DRAWCHARNUM
      END IF

      IF X>=17 AND X<=18 THEN
        IF Y>=11 AND Y<=12 AND SELPAGE>0 THEN
          SELPAGE=SELPAGE-1
          GOSUB READPAGE
          GOSUB DRAWCHARNUM
        END IF
        IF Y>=13 AND Y<=14 AND SELPAGE<3 THEN
          SELPAGE=SELPAGE+1
          GOSUB READPAGE
          GOSUB DRAWCHARNUM
        END IF
      END IF

      IF X>=14 AND X<=15 THEN
        IF Y>=2 AND Y<=3 THEN GOSUB BCLEAR
        IF Y>=4 AND Y<=5 THEN GOSUB BCUT
        IF Y>=6 AND Y<=7 THEN GOSUB BCOPY
        IF Y>=8 AND Y<=9 THEN GOSUB BPASTE
      END IF
      IF X>=17 AND X<=18 THEN
        IF Y>=2 AND Y<=3 THEN GOTO BLOAD
        IF Y>=4 AND Y<=5 THEN GOSUB BSAVE
        IF Y>=6 AND Y<=7 THEN GOSUB BFONT
        IF Y>=8 AND Y<=9 THEN GOTO BNEW
      END IF

      OLDX=X
      OLDY=Y
    END IF
  ELSE
    OLDX=-1
  END IF
  IF HIDECOUNT>0 THEN
    HIDECOUNT=HIDECOUNT-1
    IF HIDECOUNT=0 THEN GOSUB HIDESELCHAR
  END IF
  WAIT VBL
LOOP

DRAWUI:
BG COPY 0,0,20,16 TO 0,0
FONT (7,,,,),
TEXT 0,0," CHARACTER DESIGNER "
SPRITE.A 0,(6,0,0,0,0)
SPRITE.A 1,(6,1,0,0,0)
SPRITE.A 2,(6,0,1,0,0)
SPRITE.A 3,(6,1,1,0,0)
SPRITE.A 4,(6,0,0,0,0)
SPRITE.A 5,(6,1,0,0,0)
SPRITE.A 6,(6,0,1,0,0)
SPRITE.A 7,(6,1,1,0,0)
GOSUB DRAWCHAR
GOSUB DRAWCOLORS
GOSUB DRAWSELCOLOR
GOSUB DRAWCHARNUM
GOSUB DRAWPAGE
RETURN

DRAWCHAR:
FOR PY=0 TO 7
  FOR PX=0 TO 7
    CHAR 16,(PXL(PX,PY)+1,0,,,)
    CELL PX+1,PY+2
  NEXT PX
NEXT PY
RETURN

DRAWCOLORS:
FOR CI=0 TO 3
  CHAR 192,(CI+1,,,,)
  BG FILL 10,2+CI*2 TO 11,3+CI*2
NEXT CI
RETURN

DRAWSELCOLOR:
SX=32+80
SY=32+16+SELCOLOR*2*8
SPRITE 4,SX,SY,36
SPRITE 5,SX+8,SY,36
SPRITE 6,SX,SY+8,36
SPRITE 7,SX+8,SY+8,36
RETURN

DRAWCHARNUM:
CHAR 192,(0,,,,)
BG FILL 0,15 TO 19,15
FONT (0,,,,),
TEXT 1,15,"#"
NUMBER 2,15,SELCHAR,3
NUMBER 14,15,SELPAGE+1,1
TEXT 15,15,"/4"
IF SELCHAR>=SELPAGE*64 AND SELCHAR<SELPAGE*64+64 THEN
  N=SELCHAR MOD 64
  SX=32+8+(N MOD 16)*8
  SY=32+88+INT(N/16)*8
  SPRITE 0,SX-1,SY-1,36
  SPRITE 1,SX+1,SY-1,36
  SPRITE 2,SX-1,SY+1,36
  SPRITE 3,SX+1,SY+1,36
  HIDECOUNT=60
ELSE
  GOSUB HIDESELCHAR
END IF
RETURN

HIDESELCHAR:
SPRITE 0,0,0,
SPRITE 1,0,0,
SPRITE 2,0,0,
SPRITE 3,0,0,
RETURN

SHOWMESSAGE:
CHAR 192,(7,,,,)
BG FILL 0,15 TO 19,15
FONT (7,,,,),
TEXT 1,15,MSG$
WAIT 30
GOSUB DRAWCHARNUM
RETURN

DRAWPAGE:
CHAR ,(5,,,,)
CI=128
FOR CY=11 TO 14
  FOR CX=1 TO 16
    CHAR CI,
    CELL CX,CY
    CI=CI+1
  NEXT CX
NEXT CY
RETURN

READPAGE:
COPY $A000+SELPAGE*$400,$400 TO $8800
RETURN

WRITECHAR:
AD=$A000+SELCHAR*16
FOR BI=1 TO 2
  FOR PY=0 TO 7
    V=0
    FOR PX=0 TO 7
      BV=2^(7-PX)
      IF PXL(PX,PY) AND BI THEN V=V OR BV
    NEXT PX
    POKE AD,V
    AD=AD+1
  NEXT PY
NEXT BI
GOSUB CHAR2PAGE
RETURN

CHAR2PAGE:
IF SELCHAR>=SELPAGE*64 AND SELCHAR<(SELPAGE+1)*64 THEN
  COPY $A000+SELCHAR*16,16 TO $8800+(SELCHAR MOD 64)*16
END IF
RETURN

READCHAR:
AD=$A000+SELCHAR*16
FOR PY=0 TO 7
  FOR PX=0 TO 7
    BV=2^(7-PX)
    PV=0
    IF PEEK(AD) AND BV THEN PV=1
    IF PEEK(AD+8) AND BV THEN PV=PV+2
    PXL(PX,PY)=PV
  NEXT PX
  AD=AD+1
NEXT PY
RETURN

BCLEAR:
FOR PY=0 TO 7
  FOR PX=0 TO 7
    PXL(PX,PY)=SELCOLOR
  NEXT PX
NEXT PY
GOSUB WRITECHAR
GOSUB DRAWCHAR
GOSUB CHAR2PAGE
RETURN

BCUT:
AD=$A000+SELCHAR*16
COPY AD,16 TO $B000
FILL AD,16,0
GOSUB READCHAR
GOSUB DRAWCHAR
GOSUB CHAR2PAGE
RETURN

BCOPY:
AD=$A000+SELCHAR*16
COPY AD,16 TO $B000
RETURN

BPASTE:
AD=$A000+SELCHAR*16
COPY $B000,16 TO AD
GOSUB READCHAR
GOSUB DRAWCHAR
GOSUB CHAR2PAGE
RETURN

BLOAD:
LOAD "#0",$A000
GOTO MAIN

BSAVE:
SAVE "#0:CHAR DEFAULT",$A000,$1000
MSG$="SAVED"
GOSUB SHOWMESSAGE
RETURN

BFONT:
COPY $8C00,$400 TO $A000+SELPAGE*$400
GOSUB READCHAR
GOSUB READPAGE
GOSUB DRAWCHAR
GOSUB DRAWPAGE
RETURN

BNEW:
FILL $A000,$1000,0
GOTO MAIN



#0:CHAR DEFAULT
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FF
01 01 01 01 01 01 01 01 FF FF FF FF FF FF FF FF
FF 00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF
80 80 80 80 80 80 80 80 7F 7F 7F 7F 7F 7F 7F 7F
00 00 00 00 00 00 00 FF FF FF FF FF FF FF FF FF
FF 00 00 00 00 00 00 FF 00 FF FF FF FF FF FF FF
81 81 81 81 81 81 81 81 7F 7F 7F 7F 7F 7F 7F 7F
FF 80 9A A2 A2 9B 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 31 29 31 A9 01 01 01 FF FF FF FF FF FF FF
FF 80 9A A2 A2 99 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 B9 91 91 11 01 01 01 FF FF FF FF FF FF FF
FF 80 99 A2 A2 99 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 31 A9 B1 21 01 F1 01 FF FF FF FF FF FF FF
FF 80 B1 AA B3 A2 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 19 B1 89 B1 01 F1 01 FF FF FF FF FF FF FF
80 00 00 00 00 00 00 00 7F FF FF FF FF FF FF FF
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
80 80 80 80 80 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
11 39 7D F9 F1 61 01 FF FF EF C7 EF FF FF FF FF
80 83 80 80 80 83 80 7F 7F 7F 7F 7F 7F 7F 7F FF
01 09 D5 79 D5 09 01 FF FF FF FF FF FF FF FF FF
80 80 80 80 80 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
F1 FD FD FD 3D 3D 01 FF 9F BF A7 E7 E7 FF FF FF
81 81 81 81 81 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
69 3D 3D 3D FD 3D 01 FF 9F FF E7 E7 E7 FF FF FF
FF 80 80 80 80 81 83 87 00 7F 7F 7F 7F 7F 7F 7F
FE 01 01 41 C1 C1 C1 C1 01 FF FF FF FF FF FF FF
FF 80 80 82 83 83 83 83 00 7F 7F 7F 7F 7F 7F 7F
FE 01 01 01 01 81 C1 E1 01 FF FF FF FF FF FF FF
FF 80 80 80 80 80 80 80 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
FF 80 A1 A2 A2 B9 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 11 A9 B9 29 01 01 01 FF FF FF FF FF FF FF
FF 80 99 B2 8B B2 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 29 A9 B9 91 01 01 01 FF FF FF FF FF FF FF
FF 80 B9 A2 B2 A1 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 31 A9 A9 29 01 01 01 FF FF FF FF FF FF FF
FF 80 B3 AB AA AB 80 80 00 7F 7F 7F 7F 7F 7F 7F
FE 01 A9 29 39 B9 01 01 01 FF FF FF FF FF FF FF
87 83 81 80 80 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
C1 C1 C1 C1 41 01 01 FF FF FF FF FF FF FF FF FF
83 83 83 83 82 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
E1 C1 81 01 01 01 01 FF FF FF FF FF FF FF FF FF
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
80 88 98 BE 98 88 80 7F 7F 7F 7F 7F 7F 7F 7F FF
FD FD FD FD FD 7D 01 FF FF 87 87 B7 B7 FF FF FF
80 88 8C BE 8C 88 80 7F 7F 7F 7F 7F 7F 7F 7F FF
FD FD FD FD FD 7D 01 FF FF 87 87 B7 B7 FF FF FF
84 8E 9B 9F 9B 9B 80 7F 7F 7F 7F 7F 7F 7F 7F FF
79 6D 79 6D 6D 79 01 FF FF FF FF FF FF FF FF FF
80 80 80 80 80 80 80 7F 7F 7F 7F 7F 7F 7F 7F FF
1D 3D 7D 7D 7D 7D 01 FF FF E7 C7 C7 C7 FF FF FF

#1:BG DEFAULT
14 10 01 00 01 00 01 00 01 00 01 00 01 00 01 00
01 00 01 00 01 00 01 00 01 00 01 00 01 00 01 00
01 00 01 00 01 00 01 00 01 00 03 00 06 00 06 00
06 00 06 00 06 00 06 00 06 00 06 00 03 00 06 00
06 00 03 00 03 00 06 00 06 00 06 00 06 00 06 00
03 00 02 00 10 00 10 00 10 00 10 00 10 00 10 00
10 00 10 00 07 00 01 00 01 00 04 00 02 00 08 00
09 00 01 00 28 00 29 00 04 00 02 00 10 00 10 00
10 00 10 00 10 00 10 00 10 00 10 00 07 00 01 00
01 00 04 00 02 00 18 00 19 00 01 00 38 00 39 00
04 00 02 00 10 00 10 00 10 00 10 00 10 00 10 00
10 00 10 00 07 00 01 00 01 00 04 00 02 00 0A 00
0B 00 01 00 2A 00 2B 00 04 00 02 00 10 00 10 00
10 00 10 00 10 00 10 00 10 00 10 00 07 00 01 00
01 00 04 00 02 00 1A 00 1B 00 01 00 3A 00 3B 00
04 00 02 00 10 00 10 00 10 00 10 00 10 00 10 00
10 00 10 00 07 00 01 00 01 00 04 00 02 00 0C 00
0D 00 01 00 2C 00 2D 00 04 00 02 00 10 00 10 00
10 00 10 00 10 00 10 00 10 00 10 00 07 00 01 00
01 00 04 00 02 00 1C 00 1D 00 01 00 3C 00 3D 00
04 00 02 00 10 00 10 00 10 00 10 00 10 00 10 00
10 00 10 00 07 00 01 00 01 00 04 00 02 00 0E 00
0F 00 01 00 2E 00 2F 00 04 00 02 00 10 00 10 00
10 00 10 00 10 00 10 00 10 00 10 00 07 00 01 00
01 00 04 00 02 00 1E 00 1F 00 01 00 3E 00 3F 00
04 00 01 00 06 00 06 00 06 00 06 00 06 00 06 00
06 00 06 00 05 00 06 00 06 00 05 00 05 00 06 00
06 00 06 00 06 00 06 00 01 00 02 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 20 00 21 00
04 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 30 00 31 00 04 00 02 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 22 00 23 00
04 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 32 00 33 00 04 00 01 00 01 00 01 00
01 00 01 00 01 00 01 00 01 00 01 00 01 00 01 00
01 00 01 00 01 00 01 00 01 00 01 00 01 00 01 00
01 00

